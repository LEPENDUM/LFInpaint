%  conversion matrix : XYZ to sRGB (linear)
function [RGB] = XYZ2sRGB_lin(XYZ)

%RGB(:,:,1) =  3.240970 * XYZ(:,:,1) - 1.537383   * XYZ(:,:,2) - 0.498611   * XYZ(:,:,3);
%RGB(:,:,2) = -0.969244 * XYZ(:,:,1) + 1.875968   * XYZ(:,:,2) + 0.041555   * XYZ(:,:,3);
%RGB(:,:,3) =  0.055630 * XYZ(:,:,1) - 0.203977   * XYZ(:,:,2) + 1.056972   * XYZ(:,:,3);

RGB(:,:,1) =  3.2404542 * XYZ(:,:,1) - 1.5371385   * XYZ(:,:,2) - 0.4985314   * XYZ(:,:,3);
RGB(:,:,2) = -0.9692660 * XYZ(:,:,1) + 1.8760108   * XYZ(:,:,2) + 0.0415560   * XYZ(:,:,3);
RGB(:,:,3) =  0.0556434 * XYZ(:,:,1) - 0.2040259   * XYZ(:,:,2) + 1.0572252   * XYZ(:,:,3);