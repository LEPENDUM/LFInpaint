%  conversion matrix : sRGB (linear) to XYZ
function [XYZ] = sRGB_lin2XYZ(RGB)

%XYZ(:,:,1) = 0.412391 * RGB(:,:,1) + 0.357584   * RGB(:,:,2) + 0.180481   * RGB(:,:,3);
%XYZ(:,:,2) = 0.212639 * RGB(:,:,1) + 0.715169   * RGB(:,:,2) + 0.072192   * RGB(:,:,3);
%XYZ(:,:,3) = 0.019331 * RGB(:,:,1) + 0.119195   * RGB(:,:,2) + 0.950532   * RGB(:,:,3);

XYZ(:,:,1) = 0.4124564 * RGB(:,:,1) + 0.3575761   * RGB(:,:,2) + 0.1804375   * RGB(:,:,3);
XYZ(:,:,2) = 0.2126729 * RGB(:,:,1) + 0.7151522   * RGB(:,:,2) + 0.0721750   * RGB(:,:,3);
XYZ(:,:,3) = 0.0193339 * RGB(:,:,1) + 0.1191920   * RGB(:,:,2) + 0.9503041   * RGB(:,:,3);